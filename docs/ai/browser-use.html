<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>让自动化测试Agent更好地代理你的浏览器 | Kevin's TechBlog</title>
    <meta name="description" content="A VitePress site">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/assets/style.DCAiTg5s.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.BRw579Uv.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.DeK-WOGe.js">
    <link rel="modulepreload" href="/assets/chunks/theme.1g9AFGSA.js">
    <link rel="modulepreload" href="/assets/chunks/katex.Cu_Erd72.js">
    <link rel="modulepreload" href="/assets/chunks/dagre-6UL2VRFP.BHcbTZge.js">
    <link rel="modulepreload" href="/assets/chunks/cose-bilkent-S5V4N54A.CqrHxTIX.js">
    <link rel="modulepreload" href="/assets/chunks/c4Diagram-YG6GDRKO.5jl6DUMQ.js">
    <link rel="modulepreload" href="/assets/chunks/flowDiagram-NV44I4VS.BmYtCFEI.js">
    <link rel="modulepreload" href="/assets/chunks/erDiagram-Q2GNP2WA.BIOcXSLM.js">
    <link rel="modulepreload" href="/assets/chunks/gitGraphDiagram-NY62KEGX.CG7Hbyrm.js">
    <link rel="modulepreload" href="/assets/chunks/ganttDiagram-JELNMOA3.Bh3FsI9q.js">
    <link rel="modulepreload" href="/assets/chunks/infoDiagram-WHAUD3N6.CFtX1adI.js">
    <link rel="modulepreload" href="/assets/chunks/pieDiagram-ADFJNKIX.B32PGxlV.js">
    <link rel="modulepreload" href="/assets/chunks/quadrantDiagram-AYHSOK5B.Z3IxZKd9.js">
    <link rel="modulepreload" href="/assets/chunks/xychartDiagram-PRI3JC2R.B_Yps_LP.js">
    <link rel="modulepreload" href="/assets/chunks/requirementDiagram-UZGBJVZJ.BSNX2hQC.js">
    <link rel="modulepreload" href="/assets/chunks/sequenceDiagram-WL72ISMW.B9i66s1J.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-2ON5EDUG.CqoGTrdX.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-v2-WZHVMYZB.CqoGTrdX.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-FKZM4ZOC.D8LbPzQy.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-v2-4FDKWEC3.B8mURkCd.js">
    <link rel="modulepreload" href="/assets/chunks/journeyDiagram-XKPGCS4Q.Dz6X1ih9.js">
    <link rel="modulepreload" href="/assets/chunks/timeline-definition-IT6M3QCI.CaDHYbBD.js">
    <link rel="modulepreload" href="/assets/chunks/mindmap-definition-VGOIOE7T.CS69lNta.js">
    <link rel="modulepreload" href="/assets/chunks/kanban-definition-3W4ZIXB7.D-P2d134.js">
    <link rel="modulepreload" href="/assets/chunks/sankeyDiagram-TZEHDZUN.DKaDfZpU.js">
    <link rel="modulepreload" href="/assets/chunks/diagram-S2PKOQOG.B-hdv2EM.js">
    <link rel="modulepreload" href="/assets/chunks/diagram-QEK2KX5R.hg5aZgJv.js">
    <link rel="modulepreload" href="/assets/chunks/blockDiagram-VD42YOAC.Mwz3OzI3.js">
    <link rel="modulepreload" href="/assets/chunks/architectureDiagram-VXUJARFQ.DNdT3UaC.js">
    <link rel="modulepreload" href="/assets/chunks/diagram-PSM6KHXK.Cz4c5aeZ.js">
    <link rel="modulepreload" href="/assets/chunks/virtual_mermaid-config.DDnGl6nM.js">
    <link rel="modulepreload" href="/assets/ai_browser-use.md.3sNMD2OD.lean.js">
    <link rel="icon" href="/logo.png">
    <link rel="stylesheet" href="/fancybox/fancybox.css">
    <script src="/fancybox/fancybox.umd.js" defer></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d8b57b2d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-fcbfc0e0></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-fcbfc0e0>Skip to content</a><!--]--><!----><header class="VPNav" data-v-d8b57b2d data-v-7ad780c2><div class="VPNavBar" data-v-7ad780c2 data-v-9fd4d1dd><div class="wrapper" data-v-9fd4d1dd><div class="container" data-v-9fd4d1dd><div class="title" data-v-9fd4d1dd><div class="VPNavBarTitle has-sidebar" data-v-9fd4d1dd data-v-9f43907a><a class="title" href="/" data-v-9f43907a><!--[--><!--]--><!--[--><img class="VPImage logo" src="/logo.png" alt data-v-ab19afbb><!--]--><span data-v-9f43907a>Kevin&#39;s TechBlog</span><!--[--><!--]--></a></div></div><div class="content" data-v-9fd4d1dd><div class="content-body" data-v-9fd4d1dd><!--[--><!--]--><div class="VPNavBarSearch search" data-v-9fd4d1dd><!--[--><!----><div id="docsearch"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-9fd4d1dd data-v-afb2845e><span id="main-nav-aria-label" class="visually-hidden" data-v-afb2845e> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/projects/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Build</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-afb2845e data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-bfe7971f><span class="text" data-v-bfe7971f><!----><span data-v-bfe7971f>Dev</span><span class="vpi-chevron-down text-icon" data-v-bfe7971f></span></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><div class="items" data-v-20ed86d6><!--[--><!--[--><div class="VPMenuGroup" data-v-20ed86d6 data-v-a6b0397c><p class="title" data-v-a6b0397c>前端</p><!--[--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-7eeeb2dc><a class="VPLink link" href="/javascript/" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>javascript</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-7eeeb2dc><a class="VPLink link" href="/vue/" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>vue</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-7eeeb2dc><a class="VPLink link" href="/front/" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>杂七杂八🥘</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-20ed86d6 data-v-a6b0397c><p class="title" data-v-a6b0397c>后端</p><!--[--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-7eeeb2dc><a class="VPLink link" href="/python/" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>python-Web</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-7eeeb2dc><a class="VPLink link" href="/go/" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>go-Web</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-20ed86d6 data-v-a6b0397c><p class="title" data-v-a6b0397c>AI</p><!--[--><!--[--><div class="VPMenuLink" data-v-a6b0397c data-v-7eeeb2dc><a class="VPLink link" href="/ai/" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>AI 探索</span><!--]--></a></div><!--]--><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-afb2845e data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-bfe7971f><span class="text" data-v-bfe7971f><!----><span data-v-bfe7971f>Preload</span><span class="vpi-chevron-down text-icon" data-v-bfe7971f></span></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><div class="items" data-v-20ed86d6><!--[--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-7eeeb2dc><a class="VPLink link" href="/webs/" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>计网</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-20ed86d6 data-v-7eeeb2dc><a class="VPLink link" href="/algorithm/" data-v-7eeeb2dc><!--[--><span data-v-7eeeb2dc>算法</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://dayswithvenki.top" target="_blank" rel="noreferrer" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>DaysWithVenki💖</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-9fd4d1dd data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-9fd4d1dd data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/Wadehl" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://gitee.com/Wadehl" aria-label target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><svg t="1682565025727" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2748" width="200" height="200"><path d="M512 1024C229.222 1024 0 794.778 0 512S229.222 0 512 0s512 229.222 512 512-229.222 512-512 512z m259.149-568.883h-290.74a25.293 25.293 0 0 0-25.292 25.293l-0.026 63.206c0 13.952 11.315 25.293 25.267 25.293h177.024c13.978 0 25.293 11.315 25.293 25.267v12.646a75.853 75.853 0 0 1-75.853 75.853h-240.23a25.293 25.293 0 0 1-25.267-25.293V417.203a75.853 75.853 0 0 1 75.827-75.853h353.946a25.293 25.293 0 0 0 25.267-25.292l0.077-63.207a25.293 25.293 0 0 0-25.268-25.293H417.152a189.62 189.62 0 0 0-189.62 189.645V771.15c0 13.977 11.316 25.293 25.294 25.293h372.94a170.65 170.65 0 0 0 170.65-170.65V480.384a25.293 25.293 0 0 0-25.293-25.267z" fill="#C71D23" p-id="2749"></path></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-9fd4d1dd data-v-f953d92f data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-bfe7971f><span class="vpi-more-horizontal icon" data-v-bfe7971f></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><!----><!--[--><!--[--><!----><div class="group" data-v-f953d92f><div class="item appearance" data-v-f953d92f><p class="label" data-v-f953d92f>Appearance</p><div class="appearance-action" data-v-f953d92f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-f953d92f data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f953d92f><div class="item social-links" data-v-f953d92f><div class="VPSocialLinks social-links-list" data-v-f953d92f data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/Wadehl" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://gitee.com/Wadehl" aria-label target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><svg t="1682565025727" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2748" width="200" height="200"><path d="M512 1024C229.222 1024 0 794.778 0 512S229.222 0 512 0s512 229.222 512 512-229.222 512-512 512z m259.149-568.883h-290.74a25.293 25.293 0 0 0-25.292 25.293l-0.026 63.206c0 13.952 11.315 25.293 25.267 25.293h177.024c13.978 0 25.293 11.315 25.293 25.267v12.646a75.853 75.853 0 0 1-75.853 75.853h-240.23a25.293 25.293 0 0 1-25.267-25.293V417.203a75.853 75.853 0 0 1 75.827-75.853h353.946a25.293 25.293 0 0 0 25.267-25.292l0.077-63.207a25.293 25.293 0 0 0-25.268-25.293H417.152a189.62 189.62 0 0 0-189.62 189.645V771.15c0 13.977 11.316 25.293 25.294 25.293h372.94a170.65 170.65 0 0 0 170.65-170.65V480.384a25.293 25.293 0 0 0-25.293-25.267z" fill="#C71D23" p-id="2749"></path></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-9fd4d1dd data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-9fd4d1dd><div class="divider-line" data-v-9fd4d1dd></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d8b57b2d data-v-2488c25a><div class="container" data-v-2488c25a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2488c25a><span class="vpi-align-left menu-icon" data-v-2488c25a></span><span class="menu-text" data-v-2488c25a>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2488c25a data-v-6b867909><button data-v-6b867909>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d8b57b2d data-v-42c4c606><div class="curtain" data-v-42c4c606></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-42c4c606><span class="visually-hidden" id="sidebar-aria-label" data-v-42c4c606> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 collapsible collapsed" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>前端</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-0009425e data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h3 class="text" data-v-0009425e>JavaScript基础</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/javascript/var,let,const.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>var,let,const</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/javascript/this.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>this</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/javascript/%E9%97%AD%E5%8C%85.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>闭包</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/javascript/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>垃圾回收机制GC</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-0009425e data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h3 class="text" data-v-0009425e>JavaScript手写系列</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/javascript/AJAX.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Ajax</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/javascript/Promise.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Promise</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/javascript/Promise%E5%B9%B6%E5%8F%91%E8%B0%83%E5%BA%A6.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Promise并发调度</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/javascript/curried.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>柯里化</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/javascript/debounce&amp;throttle.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>防抖与节流</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/javascript/lazyload.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>图片懒加载</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/javascript/flattern.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Array, Object扁平化</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/javascript/instanceof.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>instanceof</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/javascript/%E6%9C%89%E6%97%B6%E9%97%B4%E9%99%90%E5%88%B6%E7%9A%84%E7%BC%93%E5%AD%98.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>有时间限制的缓存</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/javascript/LazyMan.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>LazyMan</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/typescript/" data-v-0009425e><!--[--><p class="text" data-v-0009425e>TypeScript</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible collapsed" data-v-0009425e data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h3 class="text" data-v-0009425e>vue</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/vue/vue-diff.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Vue3 diff算法详解</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/vue/vue3-reactivity.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Vue3响应式系统</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/vue/vue2-easy-binding.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Vue2双向绑定</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/vue/vue-vDom.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>vDOM与diff</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-0009425e data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h3 class="text" data-v-0009425e>杂七杂八🥘</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/front/%E5%89%8D%E7%AB%AF%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81%E6%96%B9%E5%BC%8F.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>前端权限认证方式</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/front/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%B8%B2%E6%9F%93%E8%BF%87%E7%A8%8B.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>浏览器渲染过程</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/front/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>前端性能优化</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/front/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%20New.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>前端性能优化 New</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/front/%E5%89%8D%E7%AB%AF%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E2%80%94%E2%80%94%E5%AE%9E%E6%88%98.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>前端性能优化——实战</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 collapsible collapsed" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>后端</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 collapsible collapsed" data-v-0009425e data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><p class="text" data-v-0009425e>go</p><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible collapsed" data-v-0009425e data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h3 class="text" data-v-0009425e>python</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><section class="VPSidebarItem level-2 collapsible collapsed" data-v-0009425e data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h4 class="text" data-v-0009425e>Python爬虫</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-3 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/python/crawler/Python1.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>基础知识</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/python/crawler/Python2.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Request库的使用</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/python/crawler/Python3.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>数据解析</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/python/crawler/Python4.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Re模块</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/python/crawler/Python5.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Bs模块</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/python/crawler/Python6.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Xpath模块</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/python/crawler/Python7.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>爬虫实战</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/python/crawler/Python8.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Python多线程</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-2 collapsible collapsed" data-v-0009425e data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><p class="text" data-v-0009425e>Django</p><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 collapsible collapsed has-active" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>AI</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><section class="VPSidebarItem level-1 collapsible collapsed has-active" data-v-0009425e data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h3 class="text" data-v-0009425e>Browser-Use</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/ai/browser-use.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>浏览器自动化测试最佳实践</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 collapsible collapsed" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>基础知识</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-0009425e data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h3 class="text" data-v-0009425e>计网</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/webs/CDN.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>CDN</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/webs/HTTP%E7%89%88%E6%9C%AC%E5%B7%AE%E5%BC%82.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>HTTP版本差异</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/webs/HTTP%E7%9B%B8%E5%85%B3.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>HTTP相关</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/webs/HTTP%E7%BC%93%E5%AD%98.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>HTTP缓存</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/webs/WebSocket.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>WebSocket</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/webs/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>网络安全</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-0009425e data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h3 class="text" data-v-0009425e>算法</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/algorithm/LIS.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>LIS</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d8b57b2d data-v-9a6c75ad><div class="VPDoc has-sidebar has-aside" data-v-9a6c75ad data-v-e6f2a212><!--[--><!--]--><div class="container" data-v-e6f2a212><div class="aside" data-v-e6f2a212><div class="aside-curtain" data-v-e6f2a212></div><div class="aside-container" data-v-e6f2a212><div class="aside-content" data-v-e6f2a212><div class="VPDocAside" data-v-e6f2a212 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-f610f197><div class="content" data-v-f610f197><div class="outline-marker" data-v-f610f197></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-f610f197>On this page</div><ul class="VPDocOutlineItem root" data-v-f610f197 data-v-53c99d69><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e6f2a212><div class="content-container" data-v-e6f2a212><!--[--><!--]--><main class="main" data-v-e6f2a212><div style="position:relative;" class="vp-doc _ai_browser-use" data-v-e6f2a212><div><h1 id="让自动化测试agent更好地代理你的浏览器" tabindex="-1">让自动化测试Agent更好地代理你的浏览器 <a class="header-anchor" href="#让自动化测试agent更好地代理你的浏览器" aria-label="Permalink to &quot;让自动化测试Agent更好地代理你的浏览器&quot;">​</a></h1><h2 id="引言" tabindex="-1">引言 <a class="header-anchor" href="#引言" aria-label="Permalink to &quot;引言&quot;">​</a></h2><p>在自动化测试领域，让AI Agent有效地操控浏览器一直是一个充满挑战的任务。Agent需要理解页面结构、执行交互操作、验证数据一致性，但往往会遇到决策不稳定、操作失败率高、调试困难等问题。</p><p>本文将介绍一个基于 CDP + Playwright + BrowserUse 的完整解决方案，通过精心设计的工具集和架构，让AI Agent能够更可靠、更智能地代理浏览器执行自动化测试任务。</p><h2 id="技术架构-cdp-playwright-browseruse-的完美结合" tabindex="-1">技术架构：CDP + Playwright + BrowserUse 的完美结合 <a class="header-anchor" href="#技术架构-cdp-playwright-browseruse-的完美结合" aria-label="Permalink to &quot;技术架构：CDP + Playwright + BrowserUse 的完美结合&quot;">​</a></h2><h3 id="为什么选择这个技术栈" tabindex="-1">为什么选择这个技术栈 <a class="header-anchor" href="#为什么选择这个技术栈" aria-label="Permalink to &quot;为什么选择这个技术栈&quot;">​</a></h3><ul><li><strong>CDP (Chrome DevTools Protocol)</strong>：Chrome浏览器的远程调试协议，也是我们日常使用的F12开发者工具的底层实现。通过CDP，我们可以程序化地实现所有DevTools的功能，如监听网络请求、执行JavaScript、操作DOM等</li><li><strong>Playwright</strong>：成熟的跨浏览器自动化框架，提供稳定的API和丰富的功能</li><li><strong>BrowserUse</strong>：为AI Agent设计的浏览器控制框架，提供了友好的Action接口</li></ul><h3 id="三者如何协同工作" tabindex="-1">三者如何协同工作 <a class="header-anchor" href="#三者如何协同工作" aria-label="Permalink to &quot;三者如何协同工作&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>           Chrome 浏览器</span></span>
<span class="line"><span>┌────────────────────────────────────┐</span></span>
<span class="line"><span>│  渲染引擎 (Blink)  │  JS引擎 (V8)    │</span></span>
<span class="line"><span>│────────────────────────────────────│</span></span>
<span class="line"><span>│        CDP Server (Port 9222)      │</span></span>
<span class="line"><span>└───────────────┬────────────────────┘</span></span>
<span class="line"><span>                │ WebSocket</span></span>
<span class="line"><span>     ┌──────────┼─────────┐</span></span>
<span class="line"><span>     │                    │</span></span>
<span class="line"><span>┌────▼─────┐        ┌─────▼─────┐</span></span>
<span class="line"><span>│Playwright│        │ BrowserUse│</span></span>
<span class="line"><span>└────┬─────┘        └─────┬─────┘</span></span>
<span class="line"><span>     │                    │</span></span>
<span class="line"><span>     └───────┐     ┌──────┘</span></span>
<span class="line"><span>             │     │</span></span>
<span class="line"><span>          ┌──▼──── ▼────┐</span></span>
<span class="line"><span>          │   AI Agent  │</span></span>
<span class="line"><span>          └─────────────┘</span></span></code></pre></div><p>实际的启动和连接流程：</p><ol><li><p><strong>启动Chrome并开启CDP</strong></p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 直接通过命令行启动Chrome，开启CDP服务</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">chrome </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">remote</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">debugging</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9222</span></span></code></pre></div><p>Chrome启动后，会在内部启动一个CDP服务器，监听9222端口</p></li><li><p><strong>Playwright和BrowserUse连接到CDP</strong></p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Playwright通过CDP连接</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> playwright.chromium.connect_over_cdp(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;[http://localhost:9222](http://localhost:9222)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># BrowserUse也连接到同一个CDP</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BrowserSession(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cdp_url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;[http://localhost:9222](http://localhost:9222)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div></li></ol><p>这样设计的好处是：Playwright和BrowserUse共享同一个浏览器实例，避免了资源浪费，同时可以充分利用两者的优势。</p><h3 id="cdp-devtools的幕后英雄" tabindex="-1">CDP：DevTools的幕后英雄 <a class="header-anchor" href="#cdp-devtools的幕后英雄" aria-label="Permalink to &quot;CDP：DevTools的幕后英雄&quot;">​</a></h3><p>值得一提的是，CDP正是我们日常开发中使用的F12开发者工具的底层实现。当你按下F12时：</p><ul><li><strong>Elements面板</strong> 使用 <code>DOM.getDocument</code>、<code>DOM.querySelector</code> 等CDP命令</li><li><strong>Console面板</strong> 使用 <code>Runtime.evaluate</code> 执行JavaScript</li><li><strong>Network面板</strong> 使用 <code>Network.enable</code> 监听网络请求</li><li><strong>断点调试</strong> 使用 <code>Debugger.setBreakpoint</code> 设置断点</li></ul><p>这就是为什么Playwright和BrowserUse能够实现如此强大的浏览器控制能力——它们本质上是通过程序化的方式使用&quot;开发者工具&quot;。</p><h2 id="核心能力一-智能的网络请求拦截与数据代理" tabindex="-1">核心能力一：智能的网络请求拦截与数据代理 <a class="header-anchor" href="#核心能力一-智能的网络请求拦截与数据代理" aria-label="Permalink to &quot;核心能力一：智能的网络请求拦截与数据代理&quot;">​</a></h2><h3 id="playwright网络监听的实现" tabindex="-1">Playwright网络监听的实现 <a class="header-anchor" href="#playwright网络监听的实现" aria-label="Permalink to &quot;Playwright网络监听的实现&quot;">​</a></h3><p>通过Playwright的网络监听能力，我们可以捕获所有的HTTP请求和响应：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 监听所有网络响应</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> on_response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(response: Response) -&gt; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">None</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    event </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> NetworkEvent(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        event_type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;response&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        method</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">response.request.method,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">response.url,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">response.status,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        headers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">response.headers</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 智能识别需要捕获的响应</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">._should_capture_response_body(response.url):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        body </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response.text()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        event.response_body </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> body</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 自动解析不同格式的数据</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">._parse_response_data(response.url, body)</span></span></code></pre></div><h3 id="通用的响应数据捕获策略" tabindex="-1">通用的响应数据捕获策略 <a class="header-anchor" href="#通用的响应数据捕获策略" aria-label="Permalink to &quot;通用的响应数据捕获策略&quot;">​</a></h3><p>系统支持多种数据格式的自动识别和解析：</p><ol><li><strong>JSON API</strong>：标准的RESTful接口</li><li><strong>JSONP</strong>：带回调函数的跨域数据格式</li><li><strong>GraphQL</strong>：结构化查询语言响应</li><li><strong>Form Data</strong>：表单提交的结构化数据</li></ol><h3 id="封装为browseruse-tools供agent调用" tabindex="-1">封装为BrowserUse.Tools供Agent调用 <a class="header-anchor" href="#封装为browseruse-tools供agent调用" aria-label="Permalink to &quot;封装为BrowserUse.Tools供Agent调用&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@tools.action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    description</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;查询网络接口数据，支持按URL关键词过滤&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> query_network_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(keyword: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) -&gt; ActionResult:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    通用的网络数据查询工具</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    Args:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        keyword: URL关键词，用于过滤特定接口</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    Returns:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        包含解析后数据的ActionResult</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 实现细节...</span></span></code></pre></div><h3 id="实际应用场景" tabindex="-1">实际应用场景 <a class="header-anchor" href="#实际应用场景" aria-label="Permalink to &quot;实际应用场景&quot;">​</a></h3><h3 id="示例-验证游戏背包数据" tabindex="-1">示例：验证游戏背包数据 <a class="header-anchor" href="#示例-验证游戏背包数据" aria-label="Permalink to &quot;示例：验证游戏背包数据&quot;">​</a></h3><p>在一个游戏活动测试中，Agent需要验证页面显示的背包物品是否与接口返回的数据一致：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Agent通过工具获取接口数据</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">backpack_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> query_network_data(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">keyword</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;listAward&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 自动解析JSONP格式</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># jsonpCallback123({&quot;awards&quot;: [{&quot;name&quot;: &quot;金币&quot;, &quot;count&quot;: 1000}]})</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 解析后得到：{&quot;awards&quot;: [{&quot;name&quot;: &quot;金币&quot;, &quot;count&quot;: 1000}]}</span></span></code></pre></div><h2 id="核心能力二-精准的浏览器控制与状态管理" tabindex="-1">核心能力二：精准的浏览器控制与状态管理 <a class="header-anchor" href="#核心能力二-精准的浏览器控制与状态管理" aria-label="Permalink to &quot;核心能力二：精准的浏览器控制与状态管理&quot;">​</a></h2><h3 id="自动登录状态管理" tabindex="-1">自动登录状态管理 <a class="header-anchor" href="#自动登录状态管理" aria-label="Permalink to &quot;自动登录状态管理&quot;">​</a></h3><p>传统方式下，Agent需要自己找到登录入口、输入账号密码、处理验证码等复杂流程。我们提供了更直接的方案：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@tools.action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    description</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;执行自动登录。传入域名，自动完成登录流程&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_login_state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(domain: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) -&gt; ActionResult:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 封装函数逻辑，请求接口获取免登录URL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    login_url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> get_auto_login_url(domain)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 直接导航到免登录链接</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> playwright_page.goto(login_url)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 等待登录完成并记录状态</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> asyncio.sleep(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ActionResult(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        extracted_content</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;登录已完成&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        metadata</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;login_url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: login_url, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span></code></pre></div><h3 id="dom元素的智能操作" tabindex="-1">DOM元素的智能操作 <a class="header-anchor" href="#dom元素的智能操作" aria-label="Permalink to &quot;DOM元素的智能操作&quot;">​</a></h3><h3 id="可见性检测" tabindex="-1">可见性检测 <a class="header-anchor" href="#可见性检测" aria-label="Permalink to &quot;可见性检测&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@tools.action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    description</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;检查DOM元素是否在可视范围内&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> is_dom_visible</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dom_id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) -&gt; ActionResult:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    visibility_info </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> playwright_page.evaluate(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        (elementId) =&gt; {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            const element = document.getElementById(elementId);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            if (!element) return </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{exists</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            const rect = element.getBoundingClientRect();</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            const inViewport = (</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                [rect.top](http://rect.top) &lt; window.innerHeight &amp;&amp;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                rect.bottom &gt; 0 &amp;&amp;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                rect.left &lt; window.innerWidth &amp;&amp;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                rect.right &gt; 0</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            );</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            </span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            return {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                exists: true,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                visible: inViewport,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                position: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{top</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> [rect.top](http://rect.top), left: rect.left}</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">            };</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        }</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, dom_id)</span></span></code></pre></div><h3 id="智能滚动定位" tabindex="-1">智能滚动定位 <a class="header-anchor" href="#智能滚动定位" aria-label="Permalink to &quot;智能滚动定位&quot;">​</a></h3><p>当需要操作的元素不在视口内时，Agent经常会尝试多次滚动但仍然找不到目标。我们的工具确保一次成功：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@tools.action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    description</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;查找并滚动到指定元素，支持多个可能的ID&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> find_and_scroll_to_element</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dom_ids: list[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) -&gt; ActionResult:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 依次尝试每个ID，找到第一个存在的元素</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dom_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dom_ids:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        element </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> page.query_selector(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;#</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dom_id</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> element:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> element.scroll_into_view_if_needed()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ActionResult(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">success</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">found_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dom_id)</span></span></code></pre></div><h3 id="为什么这些操作不能完全依赖agent" tabindex="-1">为什么这些操作不能完全依赖Agent <a class="header-anchor" href="#为什么这些操作不能完全依赖agent" aria-label="Permalink to &quot;为什么这些操作不能完全依赖Agent&quot;">​</a></h3><p><img src="/ai/browser-use-agent-decision.png" alt="Agent决策问题示意图" data-fancybox="gallery"></p><p>从实践中我们发现，当让Agent完全自主决策时，会出现以下问题：</p><ol><li><strong>重复尝试</strong>：Agent可能会多次尝试相同的操作，即使已经失败</li><li><strong>路径选择混乱</strong>：面对多种可能的操作路径，Agent的选择往往不是最优的</li><li><strong>错误恢复困难</strong>：一旦操作失败，Agent很难自动恢复到正确状态</li></ol><p>通过提供确定性的工具，我们将&quot;如何做&quot;的决策权从Agent转移到工具本身，Agent只需要决定&quot;做什么&quot;。</p><h2 id="核心能力三-可靠的tab管理体系" tabindex="-1">核心能力三：可靠的Tab管理体系 <a class="header-anchor" href="#核心能力三-可靠的tab管理体系" aria-label="Permalink to &quot;核心能力三：可靠的Tab管理体系&quot;">​</a></h2><h3 id="browseruse原生tab管理的局限性" tabindex="-1">BrowserUse原生Tab管理的局限性 <a class="header-anchor" href="#browseruse原生tab管理的局限性" aria-label="Permalink to &quot;BrowserUse原生Tab管理的局限性&quot;">​</a></h3><p>在使用BrowserUse的原生Tab管理功能时，我们遇到了一些问题：</p><ul><li><strong>关闭错误</strong>：尝试关闭Tab时可能会失败或关闭错误的Tab</li><li><strong>切换不稳定</strong>：切换到指定Tab的操作成功率不高</li><li><strong>黑盒操作</strong>：难以调试和追踪Tab状态，即使发生错误，我们也不知道是Agent调用的Tab id就是错误的，还是BrowserUse链接CDP导致内部某些异常</li></ul><h3 id="基于playwright的tab管理方案" tabindex="-1">基于Playwright的Tab管理方案 <a class="header-anchor" href="#基于playwright的tab管理方案" aria-label="Permalink to &quot;基于Playwright的Tab管理方案&quot;">​</a></h3><p>我们开发了一套更可靠的Tab管理工具：</p><h3 id="标记初始页" tabindex="-1">标记初始页 <a class="header-anchor" href="#标记初始页" aria-label="Permalink to &quot;标记初始页&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@tools.action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    description</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;标记当前Tab为初始活动页&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mark_current_tab_as_initial</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(take_action</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) -&gt; ActionResult:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    initial_tab_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> get_current_page_target_id()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    _browser_manager.initial_activity_tab_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> initial_tab_id</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ActionResult(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        extracted_content</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;已标记初始活动页: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">initial_tab_id</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span></code></pre></div><h3 id="批量清理外跳tab" tabindex="-1">批量清理外跳Tab <a class="header-anchor" href="#批量清理外跳tab" aria-label="Permalink to &quot;批量清理外跳Tab&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@tools.action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    description</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;关闭除初始页外的所有Tab并返回&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> close_all_tabs_and_return_to_initial</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(take_action</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) -&gt; ActionResult:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 获取所有Tab</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    all_tabs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> get_all_tabs_info()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 关闭非初始页的Tab</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tab </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> all_tabs:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [tab.target](http:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">//</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tab.target)_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> initial_tab_id:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> close_tab([tab.target](http:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">//</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tab.target)_id)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 切换回初始页</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> switch_to_tab(initial_tab_id)</span></span></code></pre></div><h3 id="在prompt中强制使用tab-tools" tabindex="-1">在Prompt中强制使用Tab Tools <a class="header-anchor" href="#在prompt中强制使用tab-tools" aria-label="Permalink to &quot;在Prompt中强制使用Tab Tools&quot;">​</a></h3><p>通过在任务prompt中明确要求Agent使用特定的Tab管理工具，我们显著提高了任务成功率：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>任务步骤：</span></span>
<span class="line"><span>1. 使用 mark_current_tab_as_initial 标记当前页面</span></span>
<span class="line"><span>2. 点击所有外跳链接进行验证</span></span>
<span class="line"><span>3. 完成后必须使用 close_all_tabs_and_return_to_initial 返回</span></span></code></pre></div><h2 id="最佳实践-如何编写高效的测试任务" tabindex="-1">最佳实践：如何编写高效的测试任务 <a class="header-anchor" href="#最佳实践-如何编写高效的测试任务" aria-label="Permalink to &quot;最佳实践：如何编写高效的测试任务&quot;">​</a></h2><h3 id="工具选择策略" tabindex="-1">工具选择策略 <a class="header-anchor" href="#工具选择策略" aria-label="Permalink to &quot;工具选择策略&quot;">​</a></h3><ol><li><strong>确定性操作用工具</strong>：登录、滚动、Tab管理等</li><li><strong>探索性操作给Agent</strong>：查找元素、理解内容、做判断</li></ol><h3 id="prompt工程技巧" tabindex="-1">Prompt工程技巧 <a class="header-anchor" href="#prompt工程技巧" aria-label="Permalink to &quot;Prompt工程技巧&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 好的prompt示例</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">prompt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1. 首先使用 get_login_state 确保已登录</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">2. 使用 query_network_data(keyword=&quot;listAward&quot;) 获取背包数据</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">3. 对比页面显示和接口数据是否一致</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">4. 如果需要滚动，使用 find_and_scroll_to_element</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 避免的prompt</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">avoid_prompt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1. 登录系统</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">2. 查看背包数据</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">3. 验证数据一致性</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 太模糊，Agent需要自己决策太多细节</span></span></code></pre></div><h3 id="性能优化" tabindex="-1">性能优化 <a class="header-anchor" href="#性能优化" aria-label="Permalink to &quot;性能优化&quot;">​</a></h3><ul><li><strong>选择性捕获</strong>：只捕获需要的网络请求，避免内存溢出</li><li><strong>数据缓存</strong>：相同的请求不重复解析</li><li><strong>并行执行</strong>：多个独立的验证任务可以并行</li></ul><h3 id="browseruse-tools-定义的最佳实践" tabindex="-1">BrowserUse.Tools 定义的最佳实践 <a class="header-anchor" href="#browseruse-tools-定义的最佳实践" aria-label="Permalink to &quot;BrowserUse.Tools 定义的最佳实践&quot;">​</a></h3><p>在定义BrowserUse的自定义工具时，有一个重要的实践经验：</p><h3 id="为无参数工具添加默认参数" tabindex="-1">为无参数工具添加默认参数 <a class="header-anchor" href="#为无参数工具添加默认参数" aria-label="Permalink to &quot;为无参数工具添加默认参数&quot;">​</a></h3><p>当工具不需要任何参数就可以执行时，<strong>强烈建议添加一个无意义的默认参数</strong>。这是因为AI Agent在调用空参数工具时，经常会自作主张地添加一些不存在的参数，导致Pydantic模型校验失败。</p><p><img src="/ai/browser-use-parameter-error.png" alt="Agent参数错误示意图" data-fancybox="gallery"></p><p>如图，<code>get_login_state</code> 不需要传递任何参数，但是Agent调用的时候调用的时候就是添加了<code>activity_id</code> 的参数，导致工具报错。</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ❌ 不好的定义</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@tools.action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    description</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;获取所有支持的域名列表&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_all_domains</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() -&gt; ActionResult:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Agent可能会传入 {&quot;_placeholder&quot;: &quot;&quot;} 导致错误</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pass</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ✅ 好的定义</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@tools.action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    description</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;获取所有支持的域名列表&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_all_domains</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(take_action: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bool</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) -&gt; ActionResult:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    Args:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        take_action: 是否执行操作（默认True，兼容BrowserUse LLM行为模式的占位参数）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 现在Agent可以传入 {&quot;take_action&quot;: true} 或空参数，都能正常工作</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    pass</span></span></code></pre></div><h3 id="其他工具定义建议" tabindex="-1">其他工具定义建议 <a class="header-anchor" href="#其他工具定义建议" aria-label="Permalink to &quot;其他工具定义建议&quot;">​</a></h3><ol><li><strong>明确的描述</strong>：工具描述应该清晰地说明工具的作用和使用场景</li><li><strong>结构化返回</strong>：使用ActionResult的metadata字段返回结构化数据，方便Agent解析</li><li><strong>错误处理</strong>：总是返回ActionResult，使用error字段传递错误信息，而不是抛出异常</li><li><strong>幂等性</strong>：尽量让工具具有幂等性，多次调用产生相同结果</li></ol><p>这些实践经验可以显著提高Agent调用工具的成功率，减少因参数验证失败导致的重试。</p><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><p>通过CDP + Playwright + BrowserUse的技术组合，配合精心设计的工具集，我们成功解决了AI Agent在浏览器自动化测试中的诸多挑战：</p><ol><li><strong>网络数据透明化</strong>：Agent可以轻松获取和验证接口数据</li><li><strong>操作确定性</strong>：关键操作通过工具保证成功率</li><li><strong>Tab管理可控</strong>：解决了BrowserUse集成工具在该架构下使用不稳定问题</li><li><strong>效率大幅提升</strong>：相同任务所需的Agent数量和时间都大幅减少</li></ol><p>这套方案特别适合于：</p><ul><li>需要大量重复操作的回归测试</li><li>多语言、多环境的兼容性测试</li><li>数据一致性要求高的业务测试</li><li>复杂交互流程的端到端测试</li></ul><hr><p><em>本文介绍的完整代码实现可以在 <a href="https://github.com/Wadehl/browseruse-cdp-best-practise" target="_blank" rel="noreferrer">GitHub仓库</a> 获取。如果你在自动化测试中也遇到类似挑战，欢迎尝试这套方案。</em></p></div></div></main><footer class="VPDocFooter" data-v-e6f2a212 data-v-1bcd8184><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-1bcd8184><span class="visually-hidden" id="doc-footer-aria-label" data-v-1bcd8184>Pager</span><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link prev" href="/python/crawler/Python8.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Previous page</span><span class="title" data-v-1bcd8184>Python多线程</span><!--]--></a></div><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link next" href="/webs/CDN.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Next page</span><span class="title" data-v-1bcd8184>CDN</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-d8b57b2d data-v-566314d4><div class="container" data-v-566314d4><p class="message" data-v-566314d4>Released under the MIT License.</p><p class="copyright" data-v-566314d4>Copyright © 2022-present Kevin Kwok</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"ai_browser-use.md\":\"3sNMD2OD\",\"ai_index.md\":\"thS1IybB\",\"algorithm_index.md\":\"C700-Pfp\",\"algorithm_lis.md\":\"BpOH9gr_\",\"coding_index.md\":\"CNhFEhgh\",\"front_index.md\":\"QnzJl4vU\",\"front_前端性能优化.md\":\"CdN1Aqoc\",\"front_前端性能优化new.md\":\"CR4DLS-c\",\"front_前端性能优化——实战.md\":\"CQzFkilU\",\"front_前端权限认证方式.md\":\"zApsIWs5\",\"front_前端跨域.md\":\"fR85L6TA\",\"front_浏览器渲染过程.md\":\"CRo5CYOT\",\"go_index.md\":\"1nliFVgG\",\"index.md\":\"CFVPlZtl\",\"javascript_ajax.md\":\"CtkBkkiv\",\"javascript_curried.md\":\"BGHnQxJe\",\"javascript_debounce_throttle.md\":\"Bl-Zkgew\",\"javascript_flattern.md\":\"C8UGIUxC\",\"javascript_index.md\":\"urgsQ3Rx\",\"javascript_instanceof.md\":\"Ba85tp7h\",\"javascript_lazyload.md\":\"4uijoHKx\",\"javascript_lazyman.md\":\"BaBfOf6h\",\"javascript_promise.md\":\"N7cNGYi_\",\"javascript_promise并发调度.md\":\"BR4j-NeJ\",\"javascript_this.md\":\"juMOWlfH\",\"javascript_var_let_const.md\":\"Br9-wn11\",\"javascript_垃圾回收机制.md\":\"DtHVXzxm\",\"javascript_有时间限制的缓存.md\":\"DTsjoCp4\",\"javascript_闭包.md\":\"B0sajX1H\",\"python_crawler_python1.md\":\"D2ZSZ1wW\",\"python_crawler_python2.md\":\"DTl5EmPx\",\"python_crawler_python3.md\":\"DFD9QCZ2\",\"python_crawler_python4.md\":\"OCgOpvbM\",\"python_crawler_python5.md\":\"CN4im2AU\",\"python_crawler_python6.md\":\"Cl40wfPj\",\"python_crawler_python7.md\":\"6uHfCnoI\",\"python_crawler_python8.md\":\"xNcxYScQ\",\"python_index.md\":\"B4NLCRmj\",\"typescript_index.md\":\"D7xzicP7\",\"vue_index.md\":\"J5TXlFJx\",\"vue_vue-diff.md\":\"CwBGZOUi\",\"vue_vue-vdom.md\":\"DoShf7_B\",\"vue_vue2-easy-binding.md\":\"ByQirXVv\",\"vue_vue3-reactivity.md\":\"DGjuKWH1\",\"webs_cdn.md\":\"BUfBbMf1\",\"webs_http版本差异.md\":\"BTxv0Xpr\",\"webs_http相关.md\":\"BTiM8YxG\",\"webs_http缓存.md\":\"DRi1G5Fk\",\"webs_index.md\":\"CmHv2qhQ\",\"webs_websocket.md\":\"DvboXk9j\",\"webs_网络安全.md\":\"obN77Ebb\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"Kevin's TechBlog\",\"description\":\"A VitePress site\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"logo\":\"/logo.png\",\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Build\",\"link\":\"/projects/\"},{\"text\":\"Dev\",\"items\":[{\"text\":\"前端\",\"items\":[{\"text\":\"javascript\",\"link\":\"/javascript/\"},{\"text\":\"vue\",\"link\":\"/vue/\"},{\"text\":\"杂七杂八🥘\",\"link\":\"/front/\"}]},{\"text\":\"后端\",\"items\":[{\"text\":\"python-Web\",\"link\":\"/python/\"},{\"text\":\"go-Web\",\"link\":\"/go/\"}]},{\"text\":\"AI\",\"items\":[{\"text\":\"AI 探索\",\"link\":\"/ai/\"}]}]},{\"text\":\"Preload\",\"items\":[{\"text\":\"计网\",\"link\":\"/webs/\"},{\"text\":\"算法\",\"link\":\"/algorithm/\"}]},{\"text\":\"DaysWithVenki💖\",\"link\":\"https://dayswithvenki.top\"}],\"sidebar\":[{\"text\":\"前端\",\"collapsed\":true,\"items\":[{\"text\":\"JavaScript基础\",\"collapsed\":true,\"items\":[{\"text\":\"var,let,const\",\"link\":\"/javascript/var,let,const\"},{\"text\":\"this\",\"link\":\"/javascript/this\"},{\"text\":\"闭包\",\"link\":\"/javascript/闭包\"},{\"text\":\"垃圾回收机制GC\",\"link\":\"/javascript/垃圾回收机制\"}]},{\"text\":\"JavaScript手写系列\",\"collapsed\":true,\"items\":[{\"text\":\"Ajax\",\"link\":\"/javascript/AJAX\"},{\"text\":\"Promise\",\"link\":\"/javascript/Promise\"},{\"text\":\"Promise并发调度\",\"link\":\"/javascript/Promise并发调度\"},{\"text\":\"柯里化\",\"link\":\"/javascript/curried\"},{\"text\":\"防抖与节流\",\"link\":\"/javascript/debounce&throttle\"},{\"text\":\"图片懒加载\",\"link\":\"/javascript/lazyload\"},{\"text\":\"Array, Object扁平化\",\"link\":\"/javascript/flattern\"},{\"text\":\"instanceof\",\"link\":\"/javascript/instanceof\"},{\"text\":\"有时间限制的缓存\",\"link\":\"/javascript/有时间限制的缓存\"},{\"text\":\"LazyMan\",\"link\":\"/javascript/LazyMan\"}]},{\"text\":\"TypeScript\",\"link\":\"/typescript/\"},{\"text\":\"vue\",\"collapsed\":true,\"items\":[{\"text\":\"Vue3 diff算法详解\",\"link\":\"/vue/vue-diff\"},{\"text\":\"Vue3响应式系统\",\"link\":\"/vue/vue3-reactivity\"},{\"text\":\"Vue2双向绑定\",\"link\":\"/vue/vue2-easy-binding\"},{\"text\":\"vDOM与diff\",\"link\":\"/vue/vue-vDom\"}]},{\"text\":\"杂七杂八🥘\",\"collapsed\":true,\"items\":[{\"text\":\"前端权限认证方式\",\"link\":\"/front/前端权限认证方式\"},{\"text\":\"浏览器渲染过程\",\"link\":\"/front/浏览器渲染过程\"},{\"text\":\"前端性能优化\",\"link\":\"/front/前端性能优化\"},{\"text\":\"前端性能优化 New\",\"link\":\"/front/前端性能优化 New\"},{\"text\":\"前端性能优化——实战\",\"link\":\"/front/前端性能优化——实战\"}]}]},{\"text\":\"后端\",\"collapsed\":true,\"items\":[{\"text\":\"go\",\"collapsed\":true,\"items\":[]},{\"text\":\"python\",\"collapsed\":true,\"items\":[{\"text\":\"Python爬虫\",\"collapsed\":true,\"items\":[{\"text\":\"基础知识\",\"link\":\"/python/crawler/Python1\"},{\"text\":\"Request库的使用\",\"link\":\"/python/crawler/Python2\"},{\"text\":\"数据解析\",\"link\":\"/python/crawler/Python3\"},{\"text\":\"Re模块\",\"link\":\"/python/crawler/Python4\"},{\"text\":\"Bs模块\",\"link\":\"/python/crawler/Python5\"},{\"text\":\"Xpath模块\",\"link\":\"/python/crawler/Python6\"},{\"text\":\"爬虫实战\",\"link\":\"/python/crawler/Python7\"},{\"text\":\"Python多线程\",\"link\":\"/python/crawler/Python8\"}]},{\"text\":\"Django\",\"collapsed\":true,\"items\":[]}]}]},{\"text\":\"AI\",\"collapsed\":true,\"items\":[{\"text\":\"Browser-Use\",\"collapsed\":true,\"items\":[{\"text\":\"浏览器自动化测试最佳实践\",\"link\":\"/ai/browser-use\"}]}]},{\"text\":\"基础知识\",\"collapsed\":true,\"items\":[{\"text\":\"计网\",\"collapsed\":true,\"items\":[{\"text\":\"CDN\",\"link\":\"/webs/CDN\"},{\"text\":\"HTTP版本差异\",\"link\":\"/webs/HTTP版本差异\"},{\"text\":\"HTTP相关\",\"link\":\"/webs/HTTP相关\"},{\"text\":\"HTTP缓存\",\"link\":\"/webs/HTTP缓存\"},{\"text\":\"WebSocket\",\"link\":\"/webs/WebSocket\"},{\"text\":\"网络安全\",\"link\":\"/webs/网络安全\"}]},{\"text\":\"算法\",\"collapsed\":true,\"items\":[{\"text\":\"LIS\",\"link\":\"/algorithm/LIS\"}]}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/Wadehl\"},{\"icon\":{\"svg\":\"<svg t=\\\"1682565025727\\\" class=\\\"icon\\\" viewBox=\\\"0 0 1024 1024\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" p-id=\\\"2748\\\" width=\\\"200\\\" height=\\\"200\\\"><path d=\\\"M512 1024C229.222 1024 0 794.778 0 512S229.222 0 512 0s512 229.222 512 512-229.222 512-512 512z m259.149-568.883h-290.74a25.293 25.293 0 0 0-25.292 25.293l-0.026 63.206c0 13.952 11.315 25.293 25.267 25.293h177.024c13.978 0 25.293 11.315 25.293 25.267v12.646a75.853 75.853 0 0 1-75.853 75.853h-240.23a25.293 25.293 0 0 1-25.267-25.293V417.203a75.853 75.853 0 0 1 75.827-75.853h353.946a25.293 25.293 0 0 0 25.267-25.292l0.077-63.207a25.293 25.293 0 0 0-25.268-25.293H417.152a189.62 189.62 0 0 0-189.62 189.645V771.15c0 13.977 11.316 25.293 25.294 25.293h372.94a170.65 170.65 0 0 0 170.65-170.65V480.384a25.293 25.293 0 0 0-25.293-25.267z\\\" fill=\\\"#C71D23\\\" p-id=\\\"2749\\\"></path></svg>\"},\"link\":\"https://gitee.com/Wadehl\"}],\"search\":{\"provider\":\"algolia\",\"options\":{\"appId\":\"1BAFNJ6EKW\",\"apiKey\":\"39ce531d0df9398734ef70ad4e765558\",\"indexName\":\"tech-dayswithvenki\",\"placeholder\":\"请输入搜索内容\",\"initialQuery\":\"JS\"}},\"footer\":{\"message\":\"Released under the MIT License.\",\"copyright\":\"Copyright © 2022-present Kevin Kwok\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>